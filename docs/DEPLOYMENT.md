# Deployment Guide

## Overview

This guide covers the deployment process for the Personal Website 2025 project using Vercel.

## Prerequisites

- GitHub repository connected
- Vercel account created
- Environment variables configured
- Production build tested locally

## Deployment Environments

### Development
- **URL**: http://localhost:3000
- **Branch**: feature branches
- **Purpose**: Local development

### Preview
- **URL**: Auto-generated by Vercel
- **Branch**: All non-main branches
- **Purpose**: Testing and review

### Production
- **URL**: https://jerrysafterbrown.com (TBD)
- **Branch**: main
- **Purpose**: Live site

## Initial Setup

### 1. Connect to Vercel

```bash
# Install Vercel CLI (optional)
npm i -g vercel

# Login to Vercel
vercel login

# Link project
vercel link
```

### 2. Configure Project Settings

In Vercel Dashboard:

1. **Framework Preset**: Next.js
2. **Build Command**: `npm run build`
3. **Output Directory**: `.next`
4. **Install Command**: `npm install`

### 3. Environment Variables

Required environment variables:

```bash
# GitHub Integration
GITHUB_TOKEN=ghp_xxxxxxxxxxxx

# Contact Form (future)
RESEND_API_KEY=re_xxxxxxxxxxxx

# Analytics (future)
PLAUSIBLE_DOMAIN=jerrysafterbrown.com
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=jerrysafterbrown.com

# Error Tracking (future)
SENTRY_DSN=https://xxxxx@sentry.io/xxxxx
```

## Build Configuration

### next.config.ts

```typescript
import type { NextConfig } from 'next'

const nextConfig: NextConfig = {
  reactStrictMode: true,
  
  // Image optimization
  images: {
    domains: ['github.com', 'avatars.githubusercontent.com'],
    formats: ['image/avif', 'image/webp'],
  },
  
  // Security headers
  async headers() {
    return [
      {
        source: '/:path*',
        headers: [
          {
            key: 'X-DNS-Prefetch-Control',
            value: 'on'
          },
          {
            key: 'X-XSS-Protection',
            value: '1; mode=block'
          },
          {
            key: 'X-Frame-Options',
            value: 'SAMEORIGIN'
          },
          {
            key: 'X-Content-Type-Options',
            value: 'nosniff'
          },
          {
            key: 'Referrer-Policy',
            value: 'origin-when-cross-origin'
          }
        ]
      }
    ]
  },
  
  // Redirects
  async redirects() {
    return [
      {
        source: '/resume',
        destination: '/Jerry-Safter-Brown.pdf',
        permanent: false,
      },
    ]
  }
}
```

## Deployment Process

### Automatic Deployment

1. **Push to main branch**
   ```bash
   git push origin main
   ```

2. **Vercel automatically**:
   - Detects push
   - Runs build
   - Deploys to production
   - Updates DNS

### Manual Deployment

```bash
# Deploy to production
vercel --prod

# Deploy to preview
vercel
```

## Pre-deployment Checklist

### Code Quality
- [ ] All TypeScript errors resolved
- [ ] ESLint passing
- [ ] Prettier formatting applied
- [ ] No console.log statements
- [ ] Environment variables documented

### Performance
- [ ] Lighthouse scores meet targets
- [ ] Images optimized
- [ ] Fonts subset
- [ ] Bundle size within budget

### Testing
- [ ] Build succeeds locally
- [ ] All links working
- [ ] Forms validated
- [ ] Mobile responsive
- [ ] Cross-browser tested

### Content
- [ ] Copy proofread
- [ ] Images have alt text
- [ ] Meta tags updated
- [ ] Resume PDF uploaded
- [ ] 404 page created

## Monitoring

### Post-deployment Checks

1. **Functional Testing**
   - Navigation works
   - Theme switching functions
   - Contact form submits
   - External links open

2. **Performance Monitoring**
   - Check Vercel Analytics
   - Verify Core Web Vitals
   - Monitor error rates
   - Track page views

3. **SEO Verification**
   - robots.txt accessible
   - Sitemap generated
   - Meta tags rendering
   - Social previews working

## Rollback Procedure

### Via Vercel Dashboard

1. Go to Deployments tab
2. Find previous stable deployment
3. Click "..." menu
4. Select "Promote to Production"

### Via CLI

```bash
# List deployments
vercel ls

# Rollback to specific deployment
vercel rollback [deployment-url]
```

## Domain Configuration

### Primary Domain

1. Add domain in Vercel dashboard
2. Update DNS records:
   ```
   Type: A
   Name: @
   Value: 76.76.21.21
   
   Type: CNAME
   Name: www
   Value: cname.vercel-dns.com
   ```

### SSL Certificate

- Automatically provisioned by Vercel
- Force HTTPS in domain settings
- HSTS enabled by default

## CI/CD Pipeline

### GitHub Actions (Future)

```yaml
name: CI/CD

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '20'
      
      - name: Install dependencies
        run: npm ci
      
      - name: Type check
        run: npm run type-check
      
      - name: Lint
        run: npm run lint
      
      - name: Format check
        run: npm run format:check
      
      - name: Build
        run: npm run build
```

## Troubleshooting

### Build Failures

1. **Check build logs** in Vercel dashboard
2. **Common issues**:
   - Missing environment variables
   - Type errors not caught locally
   - Dependency version mismatches
   - Memory limits exceeded

### Performance Issues

1. **Analyze bundle**:
   ```bash
   npm run build
   npm run analyze
   ```

2. **Check for**:
   - Large dependencies
   - Unoptimized images
   - Missing dynamic imports
   - Inefficient data fetching

### Domain Issues

1. **DNS propagation**: Wait 24-48 hours
2. **SSL errors**: Check domain configuration
3. **Redirects**: Verify next.config.ts

## Best Practices

1. **Always test builds locally** before pushing
2. **Use preview deployments** for testing
3. **Monitor deployment metrics** regularly
4. **Keep dependencies updated** but tested
5. **Document any custom configuration**

---

*For urgent issues, check Vercel Status page and documentation.*